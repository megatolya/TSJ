#utility

Прототип сервиса для оплаты коммунальных услуг

##Что хочется

* API

* Админка на бутстрепе

* Клиент на [ратчете](http://maker.github.com/ratchet/).

* Фавиконку для спригборда айфона

* Весь клиент на ajax

* Логировать все, что логируется

* Использовать node.js + mongodb (node-orm)

##Что нужно учесть

Нужен скрипт, запускающийся раз в месяц, который списывает с баланса деньги и проверяет, не запускался ли он случайно ранее.

##API

Все описанные действия будут достпны по адресу /api/{действие}[/{id}]

###JSONы
GET /person/{id} - Возвращает строку таблицы, дополнительно возвращает квартиру и дом
GET /admin/{id}
GET /apartment/{id} - Возвращает строку таблицы, дополнительно возвращает дом и жителей
GET /realty/{id} - Возвращает строку таблицы, дополнительно возвращает список квартир

GET /money/{id}
Все выплаты по квартире + текущий баланс

GET /history/{лимит}
История всех измений не связанных со счетами

###Добавление в базу

POST /person/new
POST /admin/new
POST /apartment/new
POST /realty/new

###Прочее

POST /change
В посте содержится diff, где написано, что менять

##Структура БД

###Жильцы
* id {number}
* логин {string}
* пароль {string}
* инфа {JSON}
* квартира {ССЫЛКА НА КВАРТИРУ}

###Квартиры
* id {number}
* жильцы {JSON}
* Баланс средств {number}
* Долги за жкх услуги {number}
* Номер квартиры {string}
* Дом {ССЫЛКА НА ДОМ}

###Дома
* id  {number}
* адрес {text}
* инфа {JSON}

###Админы
* Логин {string}
* Пароль {string}
* Поддерживаемые дома {JSON}

Лог
* id {number}
* тип {string}
* событие {JSON}
