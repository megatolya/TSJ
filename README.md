#utility

Прототип сервиса для оплаты коммунальных услуг

##Что хочется

* API
* Админка на бутстрепе
* Клиент на [ратчете](http://maker.github.com/ratchet/).
* Фавиконку для спригборда айфона
* Весь клиент на ajax
* Логировать все, что логируется
* Использовать node.js + mongodb (node-orm)

##Что нужно учесть

Нужен скрипт, запускающийся раз в месяц, который списывает с баланса деньги и проверяет, не запускался ли он случайно ранее.

##API

Все описанные действия будут достпны по адресу /api/{действие}[/{id}]

###JSONы
GET /user/{id} - Возвращает строку таблицы, дополнительно возвращает квартиру и дом
GET /admin/{id}
GET /flat/{id} - Возвращает строку таблицы, дополнительно возвращает дом и жителей

GET /money/{id-flat}
Все выплаты по квартире + текущий баланс

GET /history[/{лимит}]
История всех измений не связанных со счетами


##Структура БД

###Жильцы
* Логин {String}
* Пароль {String}
* Баланс средств {Number}
* Квартира {String}
* Тип {String} [admin | user]

###Сообщения
* От кого {String}
* Кому {String}
* Время {String}
* Текст {String}

###Квартиры
* Долги за жкх услуги {Number}
* Номер квартиры {Number}

###Лог
* Тип {String} [payment | new-user | new-flat | login | logout]
* Время {String}
* Текст {String}

##Функционал на мобильнике

* Залогинивание/разлогинивание
* Оплата услуг
* Пополнение счета
* Просмотр балансов за месяц, полгода, год
* Личные сообщения
* Просмотр соседей (?)

##Установка БД для Mac OS
```bash
brew install mongodb
mkdir ~/папка для бд
mongod --dbpath ~/путь до папки для бд/
#в другом терминале
mongo
#db.test.save( { a: 1 } )
#db.test.find()
```
##Установка
```bash
make #установка
make db-start # старт базы данных (возможно придется поменяьт путь в Makefile)
make db-template # заполнить базу данных первичными данными
make db-show # распечатать в консоль всю базу данных
make db-test # отвечает работает база данных или нет в консоль
make start #старт сервера
make db-erase # очистить всю базу данных
```